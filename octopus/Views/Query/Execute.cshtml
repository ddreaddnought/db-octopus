@model octopus.Models.RunningQueryViewModel

@{
	var state = Model.Done ? "completed" : "running";
	ViewBag.Title = string.Format("{0}: {1}", state, Model.Id);
}

<div style="margin-top:20px;">
	@if (!Model.Done)
	{
		<img src="~/Content/img/spinner.gif" />
	}
	<b> @state query "@Html.DisplayFor(model => model.Id)"</b>
	<br />
	<b style="font-size: 12px;">elapsed time: @Html.DisplayFor(model => model.RunningTime)</b>

	@foreach (var result in Model.Results)
	{
		<h3>@result.DatabaseId</h3>

		<table class="table query_result">
			<tr>
				@foreach (var column in result.Columns)
				{
					<th>@column</th>
				}
			</tr>
			@foreach (var row in result.Rows)
			{
				<tr>
					@foreach(var val in row)
					{
						<td>@val</td>
					}
				</tr>
			}
		</table>
	}
</div>